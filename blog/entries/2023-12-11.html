<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../../styles.css">
    <link rel="stylesheet" href="../prism.css">
    <script src="../prism.js"></script>
    <title>Dev Log</title>
</head>
<body>
    <header>
        <h1>Player movement bug fix</h1>
        <p>Published on: <time datetime="2023-12-11">December 11, 2023</time></p>
    </header>

    <section id="content">

        <p> On the fourth day porting InfiniteAbyss, 
            I fixed a bug where the condition for the player to move was
             incorrectly determining the direction.
        </p>
        <img src="./2023-12-11.gif" alt="Character direction fault." width="300" height="auto">
<p>The issue was where we were comparing the players coordinates to the screen.
    This worked when their wasn't a camera, but since the camera moves the screen the comparison between the two was now incorrect.
     I was going to convert the coordinates to world coordinates, but I found it would be simpler to just get the screen width and compare the players coordinates to that.
      In the code below, I get the screen width and divide it by two to get the middle of the screen. Then I compare the players coordinates to the middle of the screen.
</p>
        <pre class="line-numbers"><code class="language-lua">
-- player.script

-- get screen swimWidth
local screen_width = (sys.get_config("display.width") / 2)
print(screen_width)

-- code ommited for brevity

function on_input(self, action_id, action)
-- code ommited for brevity

			-- Flip the sprite horizontal based on touch
			if action.x < screen_width then
            -- code ommited for brevity
        </code></pre>
<p>And with that change the player now correctly moves in the right direction even when the screen changes their position.</p>
                    <img src="./2023-12-11-1.gif" alt="Character direction corrected." width="300" height="auto">
<p>That is all for today, and things will be pretty slow for the next few days as I am in the midst of finals for school.</p>
    </section>

    <section id="back-to-blog">
        <a href="../../blog/blog-index.html">Back to blog index</a>
    </section>
</body>
</html>
